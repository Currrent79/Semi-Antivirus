rule banking_trojan_emotet {
    meta:
        description = "Detects Emotet banking trojan variants in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = "emotet" nocase
        $b = "httpget" nocase
        $c = { 8B 45 08 83 F8 05 74 0A }  // Emotet assembly pattern (if embedded)
        $d = "malware" nocase
        $e = "infect" nocase
        $f = /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/  // IP address
        $g = "powershell" nocase  // Possible script injection
        $h = "execute" nocase  // Command execution hint
    condition:
        3 of them and filesize < 10MB  // Increased for larger files like PDFs
}

rule ransomware_locky {
    meta:
        description = "Detects Locky ransomware variants in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = "locky" nocase
        $b = ".locky" nocase
        $c = "encrypt" nocase
        $d = "ransom" nocase
        $e = { 83 C4 04 83 EC 08 53 56 57 8B }  // Encryption loop (if embedded)
        $f = "vba" nocase  // Macro hint for Office files
        $g = "base64" nocase  // Encoded payload
    condition:
        2 of them and filesize < 5MB  // Adjusted for Office docs
}

rule virus_sality {
    meta:
        description = "Detects Sality virus family in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = { 55 8B EC 6A FF 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 64 A1 00 00 00 00 50 64 89 25 00 00 00 00 }  // PE entry (if present)
        $b = "virus" nocase
        $c = "self" nocase  // Self-replication
        $d = "script" nocase  // Possible script-based propagation
        $e = "download" nocase  // File download attempt
    condition:
        2 of them and filesize < 2MB  // Kept smaller for efficiency
}

rule spyware_remcos {
    meta:
        description = "Detects Remcos RAT spyware in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = "remcos" nocase
        $b = "keylogger" nocase
        $c = "getasync" nocase
        $d = "spy" nocase
        $e = { 6A 00 6A 00 6A 03 6A 00 6A 01 }  // Windows API (if embedded)
        $f = "javascript" nocase  // Possible JS payload
        $g = "http://" nocase  // C2 communication
    condition:
        2 of them and filesize < 10MB  // Allows for larger files
}

rule generic_malware_c2 {
    meta:
        description = "Detects generic malware with C2 communication in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = "connect" nocase
        $b = /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/
        $c = "post" nocase
        $d = "get" nocase
        $e = "command" nocase
        $f = { E8 ?? ?? ?? ?? 83 C4 04 85 C0 }  // C2 call (if embedded)
        $g = "shellcode" nocase  // Exploit hint
        $h = "https://" nocase  // Modern C2
    condition:
        3 of them and filesize < 20MB  // Broad range for various files
}

rule ransomware_wannacry {
    meta:
        description = "Detects WannaCry ransomware in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = "wcry" nocase
        $b = "wncry" nocase
        $c = "msg/money" nocase
        $d = "decrypt" nocase
        $e = { 8D 45 F4 50 FF 15 ?? ?? ?? ?? 85 C0 }  // Decryption hint (if embedded)
        $f = "macro" nocase  // Office macro possibility
        $g = "bitcoin" nocase  // Ransom payment hint
    condition:
        2 of them and filesize < 10MB  // Suitable for larger files
}

rule generic_malware {
    meta:
        description = "Detects generic malware signatures in any file type"
        author = "Saugat Sharma"
        date = "2025-07-28"
    strings:
        $a = "malware" nocase
        $b = "infect" nocase
        $c = "exploit" nocase
        $d = "payload" nocase
        $e = { 55 8B EC 83 EC 08 53 56 57 8B }  // PE entry (if present)
        $f = "download" nocase
        $g = "obfuscate" nocase  // Obfuscated code
        $h = "eval" nocase  // Script execution
    condition:
        2 of them and filesize < 50MB  // Very broad for all file types
}